spring:
  application:
    name: gateway
  cloud:
    config:
      enabled: false
      import-check:
        enabled: false
    
    gateway:
      routes:
        # Auth Service 라우팅
        - id: auth-service
          uri: http://auth-service:8081
          predicates:
            - Path=/auth/**
        
        # OAuth2 콜백 라우팅 (카카오 등 OAuth 제공자의 콜백 URL 처리)
        - id: oauth2-callback
          uri: http://auth-service:8081
          predicates:
            - Path=/oauth2/**
        
        # User Service 라우팅
        - id: user-service
          uri: http://user-service:8082
          predicates:
            - Path=/user/**  
      
      # CORS 설정
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins:
              - "http://localhost:3000"
            allowedMethods:
              - GET
              - POST
              - PUT
              - DELETE
              - OPTIONS
            allowedHeaders:
              - "*"
            allowCredentials: true
            maxAge: 3600

server:
  port: 8080

# JWT 설정 (Auth Service와 동일한 secret 사용)
jwt:
  secret: ${JWT_SECRET}

springdoc:
  api-docs:
    path: /docs/api-docs
  swagger-ui:
    path: /docs
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
    use-root-path: false
    persist-authorization: true
    show-actuator: false
    default-flat-param-object: true
    writer-with-order-by-keys: true

management:
  endpoints:
    web:
      exposure:
        include: health,info,gateway,metrics
  endpoint:
    health:
      show-details: always
    gateway:
      enabled: true

# 로깅 설정
logging:
  level:
    root: INFO
    store.kanggyoenggu: DEBUG
    # Gateway 기본 로그는 INFO로 설정 (메트릭 로그 줄이기)
    org.springframework.cloud.gateway: INFO
    org.springframework.cloud.loadbalancer: INFO
    # Micrometer 메트릭 로그는 WARN으로 설정 (상세 로그 숨김)
    io.micrometer: WARN
    io.micrometer.core.instrument: WARN
